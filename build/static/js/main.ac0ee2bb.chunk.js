(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{20:function(e,t,n){e.exports=n(36)},25:function(e,t,n){},27:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(17),i=n.n(s),o=(n(25),n(6)),l=n(7),c=n(3),u=n.n(c),m=(n(27),n(4)),p=n(5),h=n(9),d=n(8),g=n(10),f=function(){function e(){Object(m.a)(this,e)}return Object(p.a)(e,[{key:"validate",value:function(e,t){var n=this,a={};return t.forEach(function(t){var r=e[t.key];if(t.required){var s=n.required(r);if(s)return n.ensureObject(a,t.key),void(a[t.key].required=s)}Object.keys(t).filter(function(e){return"key"!==e&&"required"!==e}).forEach(function(e){if(!n[e])throw Error("\u4e0d\u5b58\u5728\u7684\u6821\u9a8c\u5668: ".concat(e));var s=n[e](r,t[e]);s&&(n.ensureObject(a,t.key),a[t.key][e]=s)})}),a}},{key:"required",value:function(e){if(0!==e&&!e)return"\u5fc5\u586b"}},{key:"pattern",value:function(e,t){if("email"===t&&(t=/^.+@.+$/),!1===t.test(e))return"\u683c\u5f0f\u4e0d\u6b63\u786e"}},{key:"minLength",value:function(e,t){if(e.length<t)return"\u592a\u77ed"}},{key:"maxLength",value:function(e,t){if(e.length>t)return"\u592a\u957f"}},{key:"ensureObject",value:function(e,t){"object"!==typeof e[t]&&(e[t]={})}}],[{key:"add",value:function(t,n){e.prototype[t]=n}}]),e}(),v=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e))).state={signInData:{nickname:"",password:""},errors:{}},n}return Object(g.a)(t,e),Object(p.a)(t,[{key:"onSignInFromValueChange",value:function(e,t){var n=e.target.value,a=JSON.parse(JSON.stringify(this.state));a.signInData[t]=n,a.errors={},this.setState(a)}},{key:"login",value:function(){var e=this,t=this.state.signInData,n=t.nickname,a=t.password,r=this.state.signInData,s=(new f).validate(r,[{key:"nickname",minLength:3},{key:"password",minLength:6}]);console.log(s),this.setState({errors:s}),Object.keys(s).length>0||u.a.User.logIn(n,a).then(function(t){console.log(t),e.props.history.push("/index")},function(t){if(210===t.code){var n=JSON.parse(JSON.stringify(e.state));n.errors.password={minLength:"\u7528\u6237\u540d\u5bc6\u7801\u4e0d\u5339\u914d"},e.setState(n)}else if(211===t.code){var a=JSON.parse(JSON.stringify(e.state));a.errors.nickName={minLength:"\u7528\u6237\u540d\u5bc6\u7801\u4e0d\u5339\u914d"},e.setState(a)}else console.log(t),console.log(typeof t),console.log(Object.keys(t)),console.log(t.code)})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"sign_up"},r.a.createElement("h1",null,"\u7528\u6237\u767b\u5f55"),r.a.createElement("p",null,r.a.createElement("input",{onChange:function(t){e.onSignInFromValueChange(t,"nickname")},value:this.state.signInData.nickname,className:this.state.errors.nickname?"middle error":"middle",type:"text",placeholder:"\u7528\u6237\u540d"}),this.state.errors.nickname?r.a.createElement("span",{className:"error-tip"},this.state.errors.nickname.minLength):""),r.a.createElement("p",null,r.a.createElement("input",{onChange:function(t){e.onSignInFromValueChange(t,"password")},value:this.state.signInData.password,className:this.state.errors.password?"middle error":"middle",type:"password",placeholder:"\u5bc6\u7801"}),this.state.errors.password?r.a.createElement("span",{className:"error-tip"},this.state.errors.password.minLength):""),r.a.createElement("p",null,r.a.createElement("input",{onClick:function(){e.login()},className:"middle-button",type:"submit",value:"\u767b\u5f55"}),r.a.createElement(o.b,{to:"/signup"},"\u53bb\u6ce8\u518c >> "))))}}]),t}(a.Component),y=Object(l.f)(v),k=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(h.a)(this,Object(d.a)(t).call(this,e))).state={signUpData:{nickname:"",email:"",password:"",confirmPassword:""},errors:{}},n}return Object(g.a)(t,e),Object(p.a)(t,[{key:"onValueChange",value:function(e,t){var n=e.target.value,a=JSON.parse(JSON.stringify(this.state));a.signUpData[t]=n,a.errors={},this.setState(a)}},{key:"onSubmitSignUpForm",value:function(){var e=this,t=this.state.signUpData,n=t.nickname,a=t.email,r=t.password,s=t.confirmPassword,i=this.state.signUpData,o=(new f).validate(i,[{key:"nickname",minLength:3},{key:"password",minLength:6},{key:"email",pattern:"email"}]);if(s!==r&&(o.confirmPassword={pattern:"\u4e24\u6b21\u5bc6\u7801\u8f93\u5165\u4e0d\u4e00\u81f4"}),console.log(o),this.setState({errors:o}),!(Object.keys(o).length>0)){var l=new u.a.User;l.setUsername(n),l.setEmail(a),l.setPassword(r),l.signUp().then(function(t){console.log("loginedUser"),console.log(t),e.props.history.push("/index")},function(t){if(125===t.code){var n=JSON.parse(JSON.stringify(e.state));n.errors.email={email:"\u90ae\u7bb1\u683c\u5f0f\u4e0d\u6b63\u786e"},e.setState(n)}else if(202===t.code){var a=JSON.parse(JSON.stringify(e.state));a.errors.nickname={minLength:"\u7528\u6237\u540d\u5df2\u88ab\u5360\u7528"},e.setState(a)}else if(203===t.code){var r=JSON.parse(JSON.stringify(e.state));r.errors.email={pattern:t.rawMessage},e.setState(r)}else console.log(t),console.log(typeof t),console.log(Object.keys(t)),console.log(t.code)})}}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"sign_up"},r.a.createElement("h1",null,"\u7528\u6237\u6ce8\u518c"),r.a.createElement("p",null,r.a.createElement("input",{onChange:function(t){e.onValueChange(t,"nickname")},value:this.state.signUpData.nickname,className:this.state.errors.nickname?"middle error":"middle",type:"text",placeholder:"\u6635\u79f0"}),this.state.errors.nickname?r.a.createElement("span",{className:"error-tip"},this.state.errors.nickname.minLength):""),r.a.createElement("p",null,r.a.createElement("input",{onChange:function(t){e.onValueChange(t,"email")},value:this.state.signUpData.email,className:this.state.errors.email?"middle error":"middle",type:"text",placeholder:"Email"}),this.state.errors.email?r.a.createElement("span",{className:"error-tip"},this.state.errors.email.pattern):""),r.a.createElement("p",null,r.a.createElement("input",{onChange:function(t){e.onValueChange(t,"password")},value:this.state.signUpData.password,className:this.state.errors.password?"middle error":"middle",type:"password",placeholder:"\u5bc6\u7801"}),this.state.errors.password?r.a.createElement("span",{className:"error-tip"},this.state.errors.password.minLength):""),r.a.createElement("p",null,r.a.createElement("input",{onChange:function(t){e.onValueChange(t,"confirmPassword")},value:this.state.signUpData.confirmPassword,className:this.state.errors.confirmPassword?"middle error":"middle",type:"password",placeholder:"\u91cd\u590d\u5bc6\u7801"}),this.state.errors.confirmPassword?r.a.createElement("span",{className:"error-tip"},this.state.errors.confirmPassword.pattern):""),r.a.createElement("p",null," ",r.a.createElement("input",{onClick:function(){e.onSubmitSignUpForm()},className:"middle-button",type:"submit",value:"\u6ce8\u518c"})," ")))}}]),t}(a.Component),w=Object(l.f)(k),E=function(e){function t(){return Object(m.a)(this,t),Object(h.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){u.a.User.current()||this.props.history.push("/signin"),this.setState({current_user:u.a.User.current()})}},{key:"logout",value:function(){var e=this;console.log("this",this.state),u.a.User.logOut().then(function(t){e.props.history.push("/signin"),console.log("logout response"),console.log(t),console.log("this2",e.state),e.setState({current_user:null})})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"container"},"\u6211\u662f\u4e3b\u9875",r.a.createElement("span",{className:"aWithoutHref",onClick:function(){e.logout()}},"\u767b\u51fa"))}}]),t}(a.Component),O=Object(l.f)(E);var b=function(){return console.log("init app"),u.a.init({appId:"FYCTcKYDOcOsKw2vnRmNvBwQ-gzGzoHsz",appKey:"BVDwbxfu4n7ziAUpuEDnf2z3"}),r.a.createElement("div",{className:"App"},r.a.createElement(o.a,null,r.a.createElement(l.d,null,r.a.createElement(l.b,{exact:!0,path:"/",render:function(){return r.a.createElement(l.a,{to:"/signin"})}}),r.a.createElement(l.b,{path:"/signin",component:y}),r.a.createElement(l.b,{path:"/signup",component:w}),r.a.createElement(l.b,{path:"/index",component:O}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(b,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[20,1,2]]]);
//# sourceMappingURL=main.ac0ee2bb.chunk.js.map